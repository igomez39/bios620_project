---
title: "Project I, BIOTAT 620W2022"
author: "Team Hot Pot; Xueting Tao, Isabel Gomez"
date: "2/14/2022"
output:
  rmarkdown::pdf_document:
    fig_caption: yes        
    includes:  
      in_header: my_header.tex
fontsize: 12pt
---


# Abstract:  Write a high-level summary of project I.  

# **Introduction:** 

The use of cell-phones and their impact on our daily lives is an ongoing relationship that scientists try to understand. Many studies have shown the impact of phones on various health outcomes such as sleep. A study conducted in 2015, showed that screen time is adversely associated with sleep time [1].  Other studies have shown that cellphone usage is associated with a later wake-up time [2]. Given these findings, we aim to study if a similar pattern arises among the screen time usage in master’s level students at the University of Michigan. The specific data collected includes total screen time in minutes, first pick-up time and the number of pickups in a day. With this specific individual-level data collected, the goal is to better understand phone usage behavior in this group. 

The hypothesis for this study is that screen-time usage is associated with later wake-up times. Here we use the first pick-up time to approximate the wake-up time. In order to test this, we fitted linear regression models using the Federal Learning and the Meta Learning process. In this study we found non-significant relationships between screen time usage and wake-up time. 


# **Data Description:** 


The data was collected between January 3rd, 2022 – February 13, 2022 (20 days) from two students in the Biostatistics 620 class is used in this study. The data was collected both from xuetao’s HUAWEI Mate 30 pro phone and isgomez's iphone. Overall following variables were collected for the study: 

* ID: the umich unique name for the individual, recorded as string type. 
* Date: Recorded everyday, recorded as date type 
* Tot.Soc.Time: Total Social Screen Time for the day, recorded in MM format 
* Pickups: Total numbers of pick-up, recorded as discrete numbers. 
* Pickup.1st: Time at first pick-up, Recorded as time type 




Table 1 above shows the drastic difference in screen usage and number of pickups between the two participants in this study. As a team, the average amount of total screen time between January 3rd - February 13, 2022 is 421 minutes or approximately 7 hours. The average social screen time is 105 minutes or 1 hour and 45 minutes and the average number of daily pickups was 96.




Figure 1 displays the pairwise scatter plots of total screen time, social screen time and number of pickups for the group. There is moderately weak significant negative correlation between total screen time and number of pickups (Pearson correlation = -0.292). Social screen time has a weak positive correlation with both total screen time (pearson correlation = 0.035) and number of pickups (pearson correlation = 0.181), both of these are non-significant. 


Figure 2 shows the first pick-up time for each member, along with the average of all the participants together. From this figure we can see that the most popular pickup time is around 7:30am. Whereas if we look at the individual pickup time, isgomez has a more variable pickup time with the earliest being at 8:30am and xuetao has a more consolidated pickup time around 7:30am. 

# Data Preprocessing: 

The data for both individuals was manually combined using an excel spreadsheet. Previous work on
 Data validation was conducted at the individual level, therefore we assume that all the data reported in this spreadsheet is accurate. In order to ensure that all the units are the same, a data transformation was made in the first-pick up time to convert the hours into minutes with midnight being 0 minutes and 11:59pm being 1440 minutes.  An additional variable was made by taking the date and converting it to weekdays (Sunday-Saturday).




# Federated Learning: 


```{r, echo=FALSE,error=FALSE,message=FALSE}

rm(list=ls(all=TRUE))  #same to clear all in stata
cat("\014")

library(xlsx)
library(dplyr)
library(lubridate)
library(stringr)
library(stringi)
library(kableExtra)
#Read in data seperately:
data_D1=read.xlsx("data/hotpot_screen_data.xlsx",sheetName ="isgomez")
data_D2=read.xlsx("data/hotpot_screen_data.xlsx",sheetName ="xuetao")

#Transfer the time into minutes:
data_D1=data_D1 %>%
  mutate(Pickup.1st.minute=(hour(Pickup.1st)*60+minute(Pickup.1st))) %>%
  mutate(pre_Tot.Scr.Time=lag(Tot.Scr.Time),
         pre_Tot.Soc.Time=lag(Tot.Soc.Time),
         X1=pre_Tot.Scr.Time,
         Schoolday=ifelse(Day %in% c("Mo","Tu","We","Th"),1,0),
         X2=Pickups,
         X1Y=X1*Pickup.1st.minute,
         X2Y=X2*Pickup.1st.minute,
         X1square=X1^2,
         X2square=X2^2,
         X1X2=X1*X2)
data_D2=data_D2 %>%
  mutate(Pickup.1st.minute=(hour(Pickup.1st)*60+minute(Pickup.1st))) %>%
  mutate(pre_Tot.Scr.Time=lag(Tot.Scr.Time),
         pre_Tot.Soc.Time=lag(Tot.Soc.Time),
         X1=pre_Tot.Scr.Time,
         Schoolday=ifelse(Day %in% c("Mo","Tu","We","Th"),1,0),
         X2=Pickups,
         X1Y=X1*Pickup.1st.minute,
         X2Y=X2*Pickup.1st.minute,
         X1square=X1^2,
         X2square=X2^2,
         X1X2=X1*X2)
data_D1=data_D1[complete.cases(data_D1),]
data_D2=data_D2[complete.cases(data_D2),]

```

Let D1 denote the data from team member 1 (Isabel) and D2 denote the data from the team member 2(Xueting). Let Y denote the time of first pick-up the following day and X denote the total screen time for the previous day. Following is the formula we used for the linear regression:

Overall Model:

$Y_i=\beta_0+\beta_1*X_{i1}+\epsilon_i$

where :

* $Y_i$ refers to First Pickup time.  
* $X_{i1}$ refers to Total Screen time in the previous day


From the principle of Simple linear regression, we could get following formula for the regression coefficients:

* $\hat{\beta_1}=\frac{SSXY(D1\cup D2)}{SSX(D1 \cup D2)}$ 
* $\hat{\beta_0}=\overline{Y}(D1 \cup D2)-\hat{\beta_1}*\overline{X}(D1 \cup D2)$ 

Overall SSXY and SSX could be obtained by the following way:

* $SSXY(D1 \cup D2)=(n_1+n_2)*\left \{ \overline{XY}(D1 \cup D2)-\overline{X}(D1 \cup D2)*\overline{Y}(D1 \cup D2) \right \}$ 
* $SSX(D1 \cup D2)= (n_1+n_2)*\left \{ \overline{X^2}(D1 \cup D2)-{\overline{X}}^2(D1 \cup D2)\right \}$ 
* $\overline{XY}(D1 \cup D2)=\frac{n_1}{n_1+n_2}*\overline{XY}(D1)+\frac{n_2}{n_1+n_2}*\overline{XY}(D2)$ 
* $\overline{X}(D1 \cup D2)=\frac{n_1}{n_1+n_2}*\overline{X}(D1)+\frac{n_2}{n_1+n_2}*\overline{X}(D2)$ 
* $\overline{Y}(D1 \cup D2)=\frac{n_1}{n_1+n_2}*\overline{Y}(D1)+\frac{n_2}{n_1+n_2}*\overline{Y}(D2)$ 
* $\overline{X^2}(D1 \cup D2)=\frac{n_1}{n_1+n_2}*\overline{X^2}(D1)+\frac{n_2}{n_1+n_2}*\overline{X^2}(D2)$ 

Also, we learned that the Standard Diviation for $\beta_1$ is defined as the following:

* $SD(\hat{\beta_1})=\sqrt{\hat{Var(\hat{\beta_1})}}=\sqrt{\frac{MSE(D1 \cup D2)}{SSX(D1 \cup D2)}}$ 
* $SD(\hat{\beta_0})=\sqrt{\hat{Var(\hat{\beta_0})}}=\sqrt{MSE*(\frac{1}{n}+\frac{\overline{X}^2(D1 \cup D2)}{SSX(D1 \cup D2)}})$ 

$MSE(D1 \cup D2)$ could be obtained by the following formula: 

* $MSE(D1 \cup D2)=\frac{SSE(D1)+SSE(D2)}{n_1+n_2-2}$ 
* $SSE=\sum_{i=1}^{n}(Y_i-\hat{Y_i})^2$ 

To test Whether the slope ($\beta_1$) is significant from 0, we use the following t-test:

* $\frac{\hat{\beta_1}-\beta_1}{\sqrt{\frac{MSE(D1 \cup D2)}{SSX(D1 \cup D2)}}}\sim t_{n_1+n_2-2}$ 

where $\beta_1=0$


Following is the result utiliziing the method above:

```{r, echo=FALSE,error=FALSE,message=FALSE}


n1=nrow(data_D1)
n2=nrow(data_D2)
#Indivdual mean
XY_D1_bar=mean(data_D1$X1Y,na.rm = T)
XY_D2_bar=mean(data_D2$X1Y,na.rm = T)
X_D1_bar=mean(data_D1$pre_Tot.Scr.Time,na.rm = T)
X_D2_bar=mean(data_D2$pre_Tot.Scr.Time,na.rm = T)
Y_D1_bar=mean(data_D1$Pickup.1st.minute,na.rm = T)
Y_D2_bar=mean(data_D2$Pickup.1st.minute,na.rm = T)
Xsquare_D1_bar=mean(data_D1$X1square,na.rm = T)
Xsquare_D2_bar=mean(data_D2$X1square,na.rm = T)
#Overall mean:
XY_D1D2_bar=n1/(n1+n2)*XY_D1_bar+n2/(n1+n2)*XY_D2_bar
Y_D1D2_bar=n1/(n1+n2)*Y_D1_bar+n2/(n1+n2)*Y_D2_bar
X_D1D2_bar=n1/(n1+n2)*X_D1_bar+n2/(n1+n2)*X_D2_bar
Xsquare_D1D2_bar=n1/(n1+n2)*Xsquare_D1_bar+n2/(n1+n2)*Xsquare_D2_bar
#SSX and SSXY:
SSXY_D1D2=(n1+n2)*(XY_D1D2_bar-X_D1D2_bar*Y_D1D2_bar)
SSX_D1D2=(n1+n2)*(Xsquare_D1D2_bar-(X_D1D2_bar)^2)
beta1_hat=SSXY_D1D2/SSX_D1D2
beta0_hat=Y_D1D2_bar-beta1_hat*X_D1D2_bar
#Pass the estimates back to the individual dataset to get the SSE:
data_D1=data_D1 %>%
  mutate(Yhat=beta0_hat+beta1_hat*pre_Tot.Scr.Time) %>%
  mutate(Ydiff_square=(Yhat-Pickup.1st.minute)^2)
data_D2=data_D2 %>%
  mutate(Yhat=beta0_hat+beta1_hat*pre_Tot.Scr.Time) %>%
  mutate(Ydiff_square=(Yhat-Pickup.1st.minute)^2)

#Calculated SSE seperately
SSE_D1=sum(data_D1$Ydiff_square,na.rm = T)
SSE_D2=sum(data_D2$Ydiff_square,na.rm = T)

#Calculate MSE:
MSE=(SSE_D1+SSE_D2)/(n1+n2-2)

#Calculate SE(beta1_hat):
SD_beta1_hat=sqrt(MSE/SSX_D1D2)
SD_beta0_hat=sqrt(MSE*(1/(n1+n2)+(X_D1D2_bar)^2/SSX_D1D2))

#T score and p value
beta1_tscore=beta1_hat/SD_beta1_hat
beta1_p=2*(1-pt(q=abs(beta1_tscore),df=n1+n2-2))


beta0_tscore=beta0_hat/SD_beta0_hat
beta0_p=2*(1-pt(q=abs(beta0_tscore),df=n1+n2-2))

#95% CI
beta1_ul=format(beta1_hat+beta1_tscore*SD_beta1_hat,digits=2)
beta1_ll=format(beta1_hat-beta1_tscore*SD_beta1_hat,digits=2)

beta0_ul=format(beta1_hat+beta0_tscore*SD_beta0_hat,digits=2)
beta0_ll=format(beta1_hat-beta0_tscore*SD_beta0_hat,digits=2)

#Output result in a table:
betalist=format(round(c(beta0_hat,beta1_hat),4))
sdlist=format(round(c(SD_beta0_hat,SD_beta1_hat),4))
tscorelist=format(round(c(beta0_tscore,beta1_tscore),4))
pvaluelist=format(round(c(beta0_p,beta1_p),3))

pvaluelist=str_replace_all(pvaluelist,"0.000","<0.001")

cilist=c(paste0(beta0_ll,",",beta0_ul),paste0(beta1_ll,",",beta1_ul))

#federal learning output table
fed_output=cbind(betalist,sdlist,tscorelist,cilist,pvaluelist)

rname=c("Intercept","Total Screen Time")
cname=c("Coefficient","SD","T-score","95%CI","P-value")
colnames(fed_output)=cname
row.names(fed_output)=rname

kable(fed_output,booktabs = T)

```

From the result above, we found that the estimated $\hat{\beta_1}$ is `r beta1_hat`, with SD=`r SD_beta1_hat`. The calculated P value is `r beta1_p` which is more than 0.05, which is non-significant. 
This results shows that there might be positive relationship between the first pick-up and the total screen time in the previous day but the relationship is not significant.

# Meta Learning: 


Overall Model:

$Y_i=\beta_0+\beta_1*X_{i1}+\beta_2*X_{i2+}\epsilon_i$

where :

* $Y_i$ refers to First Pickup time. 
* $X_{i1}$ refers to Total Screen time in the previous day 
* $X_{i2}$ refers to the Social Sreen time

From the principle of Simple linear regression, we could get following formula for the regression coefficients:

* $\hat{\beta }=(X^TX)^{-1}X^TY$ 

If we define $X_{n*3}=\begin{bmatrix} 1 & X_1^T & X_2^T \end{bmatrix}$ , $Y_{n*1}=\begin{bmatrix} Y_1 & ... & Y_n \end{bmatrix}^T$ where $X_1$, $X_2$ are row vector.

Thus, We have 

$X^TX=\begin{bmatrix}1\\ X_1\\ X_2\end{bmatrix}_{3*n}\begin{bmatrix} 1 & X_1^T & X_2^T \end{bmatrix}_{n*3}=\begin{bmatrix}n & \sum_{i=1}^{n}X_{i1} & \sum_{i=1}^{n}X_{i2} \\ \sum_{i=1}^{n}X_{i1} & \sum_{i=1}^{n}X_{i1}^2 & \sum_{i=1}^{n}X_{i1}X_{i2} \\ \sum_{i=1}^{n}X_{i2} & \sum_{i=1}^{n}X_{i1}X_{i2} & \sum_{i=1}^{n}X_{i2}^2 \end{bmatrix}$

$X^TY=\begin{bmatrix}1\\ X_1\\ X_2\end{bmatrix}_{3*n}\begin{bmatrix} Y_1 & ... & Y_n \end{bmatrix}^T_{n*1}=\begin{bmatrix} \sum_{i=1}^{n}Y_i\\ \sum_{i=1}^{n}Y_iX_{i1} \\ \sum_{i=1}^{n}Y_iX_{i2} \end{bmatrix}$

In summary:

$\hat{\beta }=\begin{bmatrix}1 & \overline{X_{1}} & \overline{X_{2}} \\ \overline{X_{1}} & \overline{X_{1}^2} & \overline{X_{1}X_{2}} \\ \overline{X_{2}} & \overline{X_{1}X_{2}} & \overline{X_{2}^2} \end{bmatrix}^{-1}\begin{bmatrix} \overline{Y}\\ \overline{YX_{1}} \\ \overline{YX_{2}}\end{bmatrix}$

Where, from Federal learning, we have :

* $\overline{YX_1}(D1 \cup D2)=\frac{n_1}{n_1+n_2}*\overline{YX_1}(D1)+\frac{n_2}{n_1+n_2}*\overline{YX_1}(D2)$  
* $\overline{YX_2}(D1 \cup D2)=\frac{n_1}{n_1+n_2}*\overline{YX_2}(D1)+\frac{n_2}{n_1+n_2}*\overline{YX_2}(D2)$ 
* $\overline{X_1}(D1 \cup D2)=\frac{n_1}{n_1+n_2}*\overline{X_1}(D1)+\frac{n_2}{n_1+n_2}*\overline{X_1}(D2)$ 
* $\overline{X_2}(D1 \cup D2)=\frac{n_1}{n_1+n_2}*\overline{X_2}(D1)+\frac{n_2}{n_1+n_2}*\overline{X_2}(D2)$ 
* $\overline{Y}(D1 \cup D2)=\frac{n_1}{n_1+n_2}*\overline{Y}(D1)+\frac{n_2}{n_1+n_2}*\overline{Y}(D2)$ 
* $\overline{X_1^2}(D1 \cup D2)=\frac{n_1}{n_1+n_2}*\overline{X_1^2}(D1)+\frac{n_2}{n_1+n_2}*\overline{X_1^2}(D2)$ 
* $\overline{X_2^2}(D1 \cup D2)=\frac{n_1}{n_1+n_2}*\overline{X_2^2}(D1)+\frac{n_2}{n_1+n_2}*\overline{X_2^2}(D2)$ 
* $\overline{X_1X_2}(D1 \cup D2)=\frac{n_1}{n_1+n_2}*\overline{X_1X_2}(D1)+\frac{n_2}{n_1+n_2}*\overline{X_1X_2}(D2)$ 


For the Variance of $\hat{\beta}$, we have the variance-covariance matrix defined as the following:

* $\hat{Var(\hat{\beta})}=\hat{\sigma^2}(X^TX)^{-1}=MSE*(X^TX)^{-1}$ 


Where

* $MSE(D1 \cup D2)=\frac{SSE(D1)+SSE(D2)}{n_1+n_2-3}$ 
* $SSE=\sum_{i=1}^{n}(Y_i-\hat{Y_i})^2$ 


To test Whether the coefficient ($\beta_1$ or $\beta_2$) is significant from 0, we use the following t-test: 

* $\frac{\hat{\beta_i}-\beta_i}{\sqrt{\hat{Var(\hat{\beta_i})}}}\sim t_{n_1+n_2-3}$ 

where $\beta_i=0$


Following is the R code implement the formula above:

```{r, echo=FALSE,error=FALSE,message=FALSE}


n1=nrow(data_D1)
n2=nrow(data_D2)
#Indivdual mean
X1Y_D1_bar=mean(data_D1$X1Y,na.rm = T)
X1Y_D2_bar=mean(data_D2$X1Y,na.rm = T)
X2Y_D1_bar=mean(data_D1$X2Y,na.rm = T)
X2Y_D2_bar=mean(data_D2$X2Y,na.rm = T)
X1_D1_bar=mean(data_D1$X1,na.rm = T)
X1_D2_bar=mean(data_D2$X1,na.rm = T)
X2_D1_bar=mean(data_D1$X2,na.rm = T)
X2_D2_bar=mean(data_D2$X2,na.rm = T)
Y_D1_bar=mean(data_D1$Pickup.1st.minute,na.rm = T)
Y_D2_bar=mean(data_D2$Pickup.1st.minute,na.rm = T)
X1square_D1_bar=mean(data_D1$X1square,na.rm = T)
X1square_D2_bar=mean(data_D2$X1square,na.rm = T)
X2square_D1_bar=mean(data_D1$X2square,na.rm = T)
X2square_D2_bar=mean(data_D2$X2square,na.rm = T)
X1X2_D1_bar=mean(data_D1$X1X2,na.rm = T)
X1X2_D2_bar=mean(data_D2$X1X2,na.rm = T)
#Overall mean:
X1Y_D1D2_bar=n1/(n1+n2)*X1Y_D1_bar+n2/(n1+n2)*X1Y_D2_bar
X2Y_D1D2_bar=n1/(n1+n2)*X2Y_D1_bar+n2/(n1+n2)*X2Y_D2_bar
Y_D1D2_bar=n1/(n1+n2)*Y_D1_bar+n2/(n1+n2)*Y_D2_bar
X1_D1D2_bar=n1/(n1+n2)*X1_D1_bar+n2/(n1+n2)*X1_D2_bar
X2_D1D2_bar=n1/(n1+n2)*X2_D1_bar+n2/(n1+n2)*X2_D2_bar
X1square_D1D2_bar=n1/(n1+n2)*X1square_D1_bar+n2/(n1+n2)*X1square_D2_bar
X2square_D1D2_bar=n1/(n1+n2)*X2square_D1_bar+n2/(n1+n2)*X2square_D2_bar
X1X2_D1D2_bar=n1/(n1+n2)*X1X2_D1_bar+n2/(n1+n2)*X1X2_D2_bar

#Matrix and beta hat
XTX_matrix=rbind(c(1,X1_D1D2_bar,X2_D1D2_bar),
                 c(X1_D1D2_bar,X1square_D1D2_bar,X1X2_D1D2_bar),
                 c(X2_D1D2_bar,X1X2_D1D2_bar,X2square_D1D2_bar))
XTX_matrix=as.matrix(XTX_matrix)
XTX_matrix_inverse=solve(XTX_matrix)
XTY_matrix=as.matrix(c(Y_D1D2_bar,X1Y_D1D2_bar,X2Y_D1D2_bar))

beta_hat=XTX_matrix_inverse %*% XTY_matrix

#MSE:
data_D1=data_D1 %>%
  mutate(yhat2=beta_hat[1,1]+beta_hat[2,1]*X1+beta_hat[3,1]*X2) %>%
  mutate(Ydiff_square2=(yhat2-Pickup.1st.minute)^2)
data_D2=data_D2 %>%
  mutate(yhat2=beta_hat[1,1]+beta_hat[2,1]*X1+beta_hat[3,1]*X2) %>%
  mutate(Ydiff_square2=(yhat2-Pickup.1st.minute)^2)

#Calculated SSE seperately
SSE_D1=sum(data_D1$Ydiff_square2,na.rm = T)
SSE_D2=sum(data_D2$Ydiff_square2,na.rm = T)

#Calculate MSE:
MSE=(SSE_D1+SSE_D2)/(n1+n2-3)

#Variance-covariance matrix:
Varhat_betahat=diag(XTX_matrix_inverse)*c(MSE)
sd_betahat=sqrt(Varhat_betahat)

#t-score:
tscorelist=beta_hat/sd_betahat
plist=2*(1-pt(q=abs(tscorelist),df=n1+n2-3))


#95% CI
ul=format(beta_hat+tscorelist*sd_betahat,digits=2)
ll=format(beta_hat-tscorelist*sd_betahat,digits=2)


#Output result in a table:

betalist=format(round(beta_hat,4))
sdlist=format(round(sqrt(Varhat_betahat),4))
tscorelist=format(round(tscorelist,4))
pvaluelist=format(round(plist,3))
pvaluelist=str_replace_all(pvaluelist,"0.000","<0.001")

cilist=c(paste0(ul,",",ll))

#federal learning output table
meta_output=cbind(betalist,sdlist,tscorelist,cilist,pvaluelist)

rname=c("Intercept","Total Screen Time","Total Pickups")
cname=c("Coefficient","SD","T-score","95%CI","P-value")
colnames(meta_output)=cname
row.names(meta_output)=rname

kable(meta_output,booktabs = T)


```




# Confirmation analysis: 

## Confirm the analysis:

### Federal learning:

Output from the overall linear regression

```{r, echo=FALSE,error=FALSE,message=FALSE}

data_overall=read.xlsx("data/hotpot_screen_data.xlsx",sheetName ="Sheet1")

#Transfer the time into minutes:
data_overall=rbind(data_D1,data_D2)

#Regression
fit=lm(Pickup.1st.minute~pre_Tot.Scr.Time,data=data_overall)
kable(summary(fit)$coef,booktabs=T)

```

Output from the federal learning:

```{r, echo=FALSE,error=FALSE,message=FALSE}
kable(fed_output,booktabs = T)
```

The coefficients and SD calculated in the federal learning is the same as the one calculated using overall data. 


### Meta learning:

Results using the overall data:

```{r, echo=FALSE,error=FALSE,message=FALSE}
fit=lm(Pickup.1st.minute~pre_Tot.Scr.Time+Pickups,data=data_overall)
kable(summary(fit)$coef,booktabs=T)


```

Results using the federal learning method

```{r, echo=FALSE,error=FALSE,message=FALSE}
kable(meta_output,booktabs = T)
```

The coefficients and SD calculated in the meta learning is the same as the one calculated using overall data.


# Conclusion & Discussion: 

To conclude, this study shows that there is a non-significant relationship between wake-up time and total screen time both in crude analysis and after adjusting for the number of pickups. Interestingly, the number of pickups is significantly associated with wake-up time, a relationship that could be further researched in future studies. This relationship may change as our sample size increases. Additionally, the status of domestic versus international students may play a role in the total amount of time used on the phone, which could also be studied in the future. 

This might be happening because the two individuals in the team have very different patterns of screen usage. As shown in figure3, xuetao has a more constrained wake-up time and isgomez has a more spread wake-up time. This might happen because the two individuals have different schedules for class. Xuetao have more class in the morning which will force her to wake up earlier while isgomez have less class in the morning and could wake up as she want. 

Thus, we further do a separated linear regression for both individuals. The significance level raised a little bit in isgomez but still not significant. This might result in that the data collected is not big enough(30 per individual) and when we do separate analysis, the uncertainty increases. This might also be due to the difference between school-days and non-school days, or there might be other factors that haven't been considered in the model. Future work might be needed to adjust more covariates like the workload of the day, the total class hour, or whether there is morning classes.

Following is the sensitivity analysis result:

### Sensitivity analysis by individual: Strafitication

* isgomez

```{r, echo=FALSE,error=FALSE,message=FALSE}
fit=lm(Pickup.1st.minute~pre_Tot.Scr.Time,data=data_D1)
unadjust_coef_isgomez=round(fit$coefficients[2],3)
unadjust_p_isgomez=round(summary(fit)$coef[2,4],3)
unadjust_isgomez=c(unadjust_coef_isgomez,unadjust_p_isgomez)

fit=lm(Pickup.1st.minute~pre_Tot.Scr.Time+Pickups,data=data_D1)
adjust_coef_isgomez=round(fit$coef[-1],3)
adjust_p_isgomez=round(summary(fit)$coef[,4][-1],3)
adjust_isgomez=cbind(adjust_coef_isgomez,adjust_p_isgomez)

tbl=c(NA,NA)
tbl=rbind(c(NA,NA),adjust_isgomez,c(NA,NA),unadjust_isgomez)
colnames(tbl)=c("Coef","p-value")
tbl=cbind(c(NA,"Total Screen time","Total Pickups",NA,"Total Screen time"),tbl)
row.names(tbl)=c("Ajusted",NA,NA,"Unadjusted",NA)
options(knitr.kable.NA = '')
kable(tbl,booktabs=T)
```


* xuetao

```{r, echo=FALSE,error=FALSE,message=FALSE}
fit=lm(Pickup.1st.minute~pre_Tot.Scr.Time,data=data_D2)
unadjust_coef_isgomez=round(fit$coefficients[2],3)
unadjust_p_isgomez=round(summary(fit)$coef[2,4],3)
unadjust_isgomez=c(unadjust_coef_isgomez,unadjust_p_isgomez)

fit=lm(Pickup.1st.minute~pre_Tot.Scr.Time+Pickups,data=data_D2)
adjust_coef_isgomez=round(fit$coef[-1],3)
adjust_p_isgomez=round(summary(fit)$coef[,4][-1],3)
adjust_isgomez=cbind(adjust_coef_isgomez,adjust_p_isgomez)

tbl=c(NA,NA)
tbl=rbind(c(NA,NA),adjust_isgomez,c(NA,NA),unadjust_isgomez)
colnames(tbl)=c("Coef","p-value")
tbl=cbind(c(NA,"Total Screen time","Total Pickups",NA,"Total Screen time"),tbl)
row.names(tbl)=c("Ajusted",NA,NA,"Unadjusted",NA)
options(knitr.kable.NA = '')
kable(tbl,booktabs=T)
```

 After stratifying by individual, we found that the data varies greatly between the two participants, which explains the non-significant relationship.

### What was your experience of data analysis, especially in the aspect of team collaboration? 

From this data analysis experience, we noticed the importance of alignment of data collecting. For example, although we have the same data frozen time, we didn’t actually have the same data enrollment date. This results in different lines of data for the two individuals. As a result, we decided to keep the same date that we both have data in order to make both of our data have similar weight. In the future study, it is not only important to control the study end time but also to control study enrollment time.
Also, from this analysis, we decided to separate the analysis into data description and federal/meta learning. Both of us contribute to our strength.

### Summarize your main contributions and findings in this project. 


Xueting worked on the Federal Learning and Meta Analysis,and edited the write-up report. Isabel worked on the data description, writing and editing the report. Both teammates contribute to the written-up of the team report. This study highlighted the difference in cell-phone usage among individuals, even when they have the same occupation (student). 

# Acknowledgement: 

  
# Appendix: 


# Reference:
  
  + [1]. Hale, L., & Guan, S. (2015). Screen time and sleep among school-aged children and adolescents: a systematic literature review. Sleep medicine reviews, 21, 50–58. https://doi.org/10.1016/j.smrv.2014.07.007 
  + [2]. Hiltunen P, Leppänen MH, Ray C, Määttä S, Vepsäläinen H, Koivusilta L, Sajaniemi N, Erkkola M, Roos E. Relationship between screen time and sleep among Finnish preschool  


   